var addLtc={init:function(e){let t=e.find(".image-upload"),i=e.find("#title-input-field"),r=e.find("#description-input-field"),o=e.find("#content-input-field"),n=e.find("#startdate-input-field"),a=e.find(".btn-save"),s=e.find("#enddate-input-field");t.change(function(e){const t=$(this),i=t.parent().find(".uploaded-image"),a=e.target.files[0];commonFuncs.validateAndResizeImage(a,function(e,t){e?i.attr("src",t):Swal.fire({icon:"error",title:"Oops...",text:"Image validation failed:"+t})})}),a.click(function(){commonFuncs.showLoader();var e={Title:i.val(),Description:r.val(),Content:o.val(),StartDate:n.val(),EndDate:s.val()},t={Image:$(".uploaded-image:first").attr("src")},a=new d;if(a.validateLTCAndImages(e,t))$.post("/Worker/AddLTCPost",{ltcDTO:e,imageDTO:t},function(e){commonFuncs.hideLoader(),Swal.fire({icon:"info",title:"Server response",html:""+e.message,showClass:{popup:"animate__animated animate__fadeInDown"},hideClass:{popup:"animate__animated animate__fadeOutUp"}}),location.reload()}).fail(function(e){commonFuncs.hideLoader(),console.log("AJAX request failed:",e)});else{commonFuncs.hideLoader();let e=a.getErrors(),i=document.createElement("ul");e.forEach(e=>{var t=document.createElement("li");t.textContent=e,t.style.color="red",t.style.textAlign="left",i.appendChild(t)}),Swal.fire({icon:"error",title:"Oops...",html:""+i.innerHTML,showClass:{popup:"animate__animated animate__fadeInDown"},hideClass:{popup:"animate__animated animate__fadeOutUp"}})}});class d{constructor(){this.errors=[]}validateLTCAndImages(e,t){return this.errors=[],this.validateLTC(e),this.validateImage(t),0===this.errors.length}validateLTC(e){e.Title&&""!==e.Title.trim()||this.errors.push("Title field is required."),e.Content&&""!==e.Content.trim()||this.errors.push("Content field is required."),e.Description&&""!==e.Description.trim()||this.errors.push("Description field is required."),e.StartDate&&""!==e.StartDate.trim()||this.errors.push("Start Date field is required."),e.EndDate&&""!==e.EndDate.trim()||this.errors.push("End Date field is required.")}validateImage(e){e.Image&&""!=e.ImageName&&" "!=e.ImageName||this.errors.push("Image is required")}getErrors(){return this.errors}}}},addProductPage={init:function(o){let e=o.find(".image-upload"),t=o.find(".btn-save"),n=o.find(".main-category-input-fields"),s=o.find("#selectCategoryDropdownId"),d=o.find("#selectSubcategoryDropdownId"),i=o.find(".sizes-input-fields"),a=o.find("#available-items-container"),c=o.find("#title-input-field"),l=o.find("#brand-input-field"),u=o.find("#price-input-field"),m=o.find("#item-colour"),f=o.find("#discount-from-price-input-field"),p=o.find("#description-input-field"),h=o.find("#return-policy-input-field");e.change(function(e){const t=$(this),i=t.parent().find(".uploaded-image"),a=e.target.files[0];commonFuncs.validateAndResizeImage(a,function(e,t){e?i.attr("src",t):Swal.fire({icon:"error",title:"Oops...",text:"Image validation failed:"+t})})}),$(".choosing-season-button").click(function(){$(".choosing-season-button").removeClass("selected"),$(this).addClass("selected")}),t.click(function(){commonFuncs.showLoader();const t=[];var e=$(".choosing-season-button.selected").text();const i=[],a=($(".sizes-input-fields:checked").each(function(){var e=$(this).attr("id"),t=o.find("#size_"+e);i.push(e+"-"+t.val())}),[]);$(".ltc-input-box:checked").each(function(){var e=$(this).attr("id");a.push(e)});var e={Title:c.val(),Brand:l.val(),Sizes:i,Colour:m.val(),Price:u.val(),DiscountFromPrice:f.val(),Description:p.val(),ReturnPolicy:h.val(),MainCategoryId:n.val(),CategoryId:s.val(),SubcategoryId:d.val(),Season:e,LTCs:a},r=($(".uploaded-image").each(function(){var e={Image:$(this).attr("src")};t.push(e)}),new g);if(r.validateProductAndImages(e,t))$.post("/Worker/AddProduct",{productDTO:e,imagesDTO:t},function(e){commonFuncs.hideLoader(),Swal.fire({icon:"info",title:"Server response",html:""+e.message,showClass:{popup:"animate__animated animate__fadeInDown"},hideClass:{popup:"animate__animated animate__fadeOutUp"}}),location.reload()}).fail(function(e){console.log("AJAX request failed:",e),commonFuncs.hideLoader()});else{commonFuncs.hideLoader();let e=r.getErrors(),i=document.createElement("ul");e.forEach(e=>{var t=document.createElement("li");t.textContent=e,t.style.color="red",t.style.textAlign="left",i.appendChild(t)}),Swal.fire({icon:"error",title:"Oops...",html:""+i.innerHTML,showClass:{popup:"animate__animated animate__fadeInDown"},hideClass:{popup:"animate__animated animate__fadeOutUp"}})}});class g{constructor(){this.errors=[]}validateProductAndImages(e,t){return this.errors=[],this.validateProduct(e),this.validateImages(t),0===this.errors.length}validateProduct(e){e.Sizes.forEach(e=>{1<(e=e.split("-")).length?(e=parseInt(e[1]),parseInt(e)!=e&&this.errors.push("The field Available Items can contain only whole number values")):this.errors.push("Size field is required.")}),e.Title&&""!==e.Title.trim()||this.errors.push("Title field is required."),e.Brand&&""!==e.Brand.trim()||this.errors.push("Brand field is required."),isNaN(e.Price)&&this.errors.push("Price field cannot contain letters/symbols."),isNaN(e.DiscountFromPrice)&&this.errors.push("Discount from price field cannot contain letters/symbols."),e.Price&&""!==e.Price.trim()||this.errors.push("Price field is required."),e.DiscountFromPrice&&""!==e.DiscountFromPrice.trim()||this.errors.push("Discount From Price Field is required."),e.Description&&""!==e.Description.trim()||this.errors.push("Description field is required."),e.ReturnPolicy&&""!==e.ReturnPolicy.trim()||this.errors.push("Return Policy field is required."),e.MainCategoryId&&""!==e.MainCategoryId.trim()||this.errors.push("Main Category field is required."),e.CategoryId&&""!==e.CategoryId.trim()||this.errors.push("Category field is required."),e.SubcategoryId&&""!==e.SubcategoryId.trim()||this.errors.push("Subcategory field is required."),e.Season&&""!==e.Season.trim()||this.errors.push("Season selection is required.")}validateImages(e){e.forEach(e=>{e.Image&&""!=e.ImageName&&" "!=e.ImageName||this.errors.push("Image is required")})}getErrors(){return this.errors}}n.click(function(){$.post("/Worker/FilterMainCategoryData",{mainCategoryId:$(this).attr("id"),categoryId:s.val()},function(e){s.empty(),s.append('<option id="0">--Select existing category--</option>'),$.each(e.categories,function(e,t){s.append('<option value="'+t.id+'">'+t.name+"</option>")}),d.empty(),d.append('<option id="0">--Select existing subcategory--</option>'),$.each(e.subcategories,function(e,t){d.append('<option value="'+t.id+'">'+t.name+"</option>")})}).fail(function(e){console.log("AJAX request failed:",e)})}),s.change(function(){var e=$("input[name='mainCategory']:checked").val();$.post("/Worker/FilterMainCategoryData",{mainCategoryId:e,categoryId:$(this).val()},function(e){d.empty(),d.append('<option id="0">--Select existing subcategory--</option>'),$.each(e,function(e,t){d.append('<option value="'+t.id+'">'+t.name+"</option>")})}).fail(function(e){console.log("AJAX request failed:",e)})}),i.on("click",function(){var e,t=$(this).attr("id");$(this).is(":checked")?(e='<div id="div_'+t+'"><label>Number of available items for '+t+'<input type="number" id="size_'+t+'" placeholder="Available Items For '+t+'" class="form-control" /> </label><hr /></div>',a.append(e)):$("#div_"+t).remove()}),d.change(function(){var e=$(this).find("option:selected");$.post("/Worker/GetCategoryBySubcategory",{subcategoryId:e.val()},function(e){s.val(e)}).fail(function(e){console.log("AJAX request failed:",e)})})}},editLtc={init:function(e){let t=e.find(".image-upload"),i=e.find("#title-input-field"),r=e.find("#description-input-field"),o=e.find("#content-input-field"),n=e.find("#startdate-input-field"),a=e.find(".btn-save"),s=e.find("#enddate-input-field");t.change(function(e){const t=$(this),i=t.parent().find(".uploaded-image"),a=e.target.files[0];commonFuncs.validateAndResizeImage(a,function(e,t){e?i.attr("src",t):Swal.fire({icon:"error",title:"Oops...",text:"Image validation failed:"+t})})}),a.click(function(){commonFuncs.showLoader();var e={Title:i.val(),Description:r.val(),Content:o.val(),StartDate:n.val(),EndDate:s.val()},t={Image:$(".uploaded-image:first").attr("src")},a=new d;if(a.validateLTCAndImages(e,t))$.post("/Worker/EditLTCPost",{ltcDTO:e,imageDTO:t},function(e){commonFuncs.hideLoader(),Swal.fire({icon:"info",title:"Server response",html:""+e.message,showClass:{popup:"animate__animated animate__fadeInDown"},hideClass:{popup:"animate__animated animate__fadeOutUp"}}),location.reload()}).fail(function(e){commonFuncs.hideLoader(),console.log("AJAX request failed:",e)});else{commonFuncs.hideLoader();let e=a.getErrors(),i=document.createElement("ul");e.forEach(e=>{var t=document.createElement("li");t.textContent=e,t.style.color="red",t.style.textAlign="left",i.appendChild(t)}),Swal.fire({icon:"error",title:"Oops...",html:""+i.innerHTML,showClass:{popup:"animate__animated animate__fadeInDown"},hideClass:{popup:"animate__animated animate__fadeOutUp"}})}});class d{constructor(){this.errors=[]}validateLTCAndImages(e,t){return this.errors=[],this.validateLTC(e),this.validateImage(t),0===this.errors.length}validateLTC(e){e.Title&&""!==e.Title.trim()||this.errors.push("Title field is required."),e.Content&&""!==e.Content.trim()||this.errors.push("Content field is required."),e.Description&&""!==e.Description.trim()||this.errors.push("Description field is required."),e.StartDate&&""!==e.StartDate.trim()||this.errors.push("Start Date field is required."),e.EndDate&&""!==e.EndDate.trim()||this.errors.push("End Date field is required.")}validateImage(e){e.Image&&""!=e.ImageName&&" "!=e.ImageName||this.errors.push("Image is required")}getErrors(){return this.errors}}}},editProductPage={init:function(o){let e=o.find(".image-upload"),n=o.find(".edit-btn-save"),s=o.find(".main-category-input-fields-edit"),d=o.find("#selectCategoryDropdownId"),c=o.find("#selectSubcategoryDropdownId"),l=o.find("#title-input-field"),u=o.find("#brand-input-field"),m=o.find("#price-input-field"),f=o.find("#item-colour"),p=o.find("#discount-from-price-input-field"),h=o.find("#description-input-field"),g=o.find("#return-policy-input-field");n.click(function(){commonFuncs.showLoader();const t=[],a=[],i=($(".sizes-input-fields:checked").each(function(){var e=$(this).attr("id"),t=o.find("#size_"+e),i=t.closest("div").attr("id").split("-"),i=i[i.length-1];a.push(`${e}-${t.val()}-${t[0].classList[1]}-`+i)}),[]);$(".ltc-input-box:checked").each(function(){var e=$(this).attr("id");i.push(e)});var e={Id:n.attr("id"),Title:l.val(),Brand:u.val(),Sizes:a,Price:m.val(),DiscountFromPrice:p.val(),Description:h.val(),ReturnPolicy:g.val(),MainCategoryId:s.val(),CategoryId:d.val(),Colour:""+f.val(),SubcategoryId:c.val(),ImageContainerId:$(".image-container").attr("id"),LTCs:i},r=($(".uploaded-image").each(function(){var e={Image:$(this).attr("src")};t.push(e)}),new v);if(r.validateProductAndImages(e,t))$.post("/Admin/EditProduct",{productDTO:e,imagesDTO:t},function(e){commonFuncs.hideLoader(),Swal.fire({icon:"info",title:"Server response",html:""+e.message,showClass:{popup:"animate__animated animate__fadeInDown"},hideClass:{popup:"animate__animated animate__fadeOutUp"}}),location.reload()}).fail(function(e){console.log("AJAX request failed:",e),commonFuncs.hideLoader()});else{commonFuncs.hideLoader();let e=r.getErrors(),i=document.createElement("ul");e.forEach(e=>{var t=document.createElement("li");t.textContent=e,t.style.color="red",t.style.textAlign="left",i.appendChild(t)}),Swal.fire({icon:"error",title:"Oops...",html:""+i.innerHTML,showClass:{popup:"animate__animated animate__fadeInDown"},hideClass:{popup:"animate__animated animate__fadeOutUp"}})}});class v{constructor(){this.errors=[]}validateProductAndImages(e,t){return this.errors=[],this.validateProduct(e),this.validateImages(t),0===this.errors.length}validateProduct(e){e.Sizes.forEach(e=>{1<(e=e.split("-")).length?(e[0],e=parseInt(e[1]),parseInt(e)!=e&&this.errors.push("The field Available Items can contain only whole number values")):this.errors.push("Size field is required.")}),e.Title&&""!==e.Title.trim()||this.errors.push("Title field is required."),e.Brand&&""!==e.Brand.trim()||this.errors.push("Brand field is required."),isNaN(e.Price)&&this.errors.push("Price field cannot contain letters/symbols."),isNaN(e.DiscountFromPrice)&&this.errors.push("Discount from price field cannot contain letters/symbols."),e.Price&&""!==e.Price.trim()||this.errors.push("Price field is required."),e.DiscountFromPrice&&""!==e.DiscountFromPrice.trim()||this.errors.push("Discount From Price Field is required."),e.Description&&""!==e.Description.trim()||this.errors.push("Description field is required."),e.ReturnPolicy&&""!==e.ReturnPolicy.trim()||this.errors.push("Return Policy field is required."),e.MainCategoryId&&""!==e.MainCategoryId.trim()||this.errors.push("Main Category field is required."),e.CategoryId&&""!==e.CategoryId.trim()||this.errors.push("Category field is required."),e.SubcategoryId&&""!==e.SubcategoryId.trim()||this.errors.push("Subcategory field is required.")}validateImages(e){e.forEach(e=>{e.Image&&""!=e.ImageName&&" "!=e.ImageName||this.errors.push("Image is required")})}getErrors(){return this.errors}}e.change(function(e){const t=$(this),i=t.parent().find(".uploaded-image"),a=e.target.files[0];commonFuncs.validateAndResizeImage(a,function(e,t){e?i.attr("src",t):Swal.fire({icon:"error",title:"Oops...",text:"Image validation failed:"+t})})}),$(document).ready(function(){s.trigger("click"),d.trigger("change")}),s.click(function(){$.post("/Admin/FilterMainCategoryData",{mainCategoryId:$(this).attr("id"),categoryId:d.val()},function(e){d.empty(),d.append('<option id="0">--Select existing category--</option>'),$.each(e.categories,function(e,t){d.append('<option value="'+t.id+'">'+t.name+"</option>")}),c.empty(),c.append('<option id="0">--Select existing subcategory--</option>'),$.each(e.subcategories,function(e,t){c.append('<option value="'+t.id+'">'+t.name+"</option>")})}).fail(function(e){console.log("AJAX request failed:",e)})}),d.on("change",function(){var e=$("#mainCategoriesRadioBtns input[type='radio']:checked");$.post("/Admin/FilterMainCategoryData",{mainCategoryId:e,categoryId:$(this).val()}).fail(function(e){console.log("AJAX request failed:",e)})}),c.change(function(){var e=$(this).find("option:selected");d.val();$.post("/Admin/GetCategoryBySubcategory",{subcategoryId:e.val()},function(e){d.val(e)}).fail(function(e){console.log("AJAX request failed:",e)})})}},manageLtcs={init:function(e){e.find(""),e.on("click",".redirect-to-edit-page",function(){var e="/Worker/EditLTC?ltcId="+$(this).attr("id");window.location.href=e}),e.on("click",".delete",function(){Swal.fire({title:"Are you sure?",text:"You won't be able to revert this product!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Delete!"}).then(e=>{e.isConfirmed&&(commonFuncs.showLoader(),$(this).closest("tr").remove(),$.post("/Worker/DeleteLTC",{ltcId:$(this).attr("id")},function(e){commonFuncs.hideLoader(),location.reload()}).fail(function(e){commonFuncs.hideLoader(),alert("AJAX request failed: ",e)}))})})}},manageProductsPage={init:function(e){e.find(""),e.on("click",".redirect-to-edit-page",function(){var e="/Worker/EditProduct?productId="+$(this).attr("id");window.location.href=e}),e.on("click",".delete",function(){Swal.fire({title:"Are you sure?",text:"You won't be able to revert this product!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Delete!"}).then(e=>{e.isConfirmed&&(commonFuncs.showLoader(),$(this).closest("tr").remove(),$.post("/Worker/DeleteProduct",{productId:$(this).attr("id")},function(e){commonFuncs.hideLoader(),location.reload()}).fail(function(e){commonFuncs.hideLoader(),alert("AJAX request failed: ",e)}))})})}},manageSubSelectionsPage={init:function(e){let t=e.find("#save-btn"),i=e.find("#add-category-row-btn"),o=e.find("#selectMainCategoryDropdownId"),a=e.find("#save-btn-div-row"),n=e.find("#mainCategoryTable"),r=0,s='<tr class="cat-row">   <td><input type="text" class="form-control category-name" required></td>   <td id="for-subcategories">       <a class="btn btn-primary col" data-toggle="collapse" href="" role="button" aria-expanded="false" aria-controls="">           Subcategories       </a>        <div class="card subcategoryTable" id="">               <div class="card-header"></div>               <div class="card-body">                 <table>                     <thead>                         <tr>                             <th>Subcategory Name</th>                             <th></th>                         </tr>                     </thead>                     <tbody class="subcategory-tbody">                         \x3c!--Add options for change--\x3e                     </tbody>                 </table>                 <button type="button" class="btn btn-primary add-subcategory-row-btn" id=""><i class="fas fa-plus"></i> Add Subcategory</button>              </div>           </div>   </td>   <td>       <button type="button" class="btn btn-danger delete-row m-1"><i class="fa fa-trash"></i></button>   </td></tr>';t.click(function(){commonFuncs.showLoader();let e=o.val(),a=[],r=[];n.find(".category-table").find("tbody .cat-row").each(function(){const e=$(this),t=e.find(".category-name").val().trim();var i={CategoryName:t};e.find("tbody .sub-row").each(function(){var e={SubcategoryName:$(this).find(".subcategory-name").val().trim(),CategoryName:t};r.push(e)}),a.push(i)});var t=new d;if(t.validateMainCategory(e,a,r))$.post("/Worker/ManageSubSelection",{mainCategoryId:e,categoriesDTO:a,subcategoriesDTO:r},function(e){commonFuncs.hideLoader(),Swal.fire({icon:"info",title:"Server response",html:""+e.message,showClass:{popup:"animate__animated animate__fadeInDown"},hideClass:{popup:"animate__animated animate__fadeOutUp"}}),location.reload()}).fail(function(e){commonFuncs.hideLoader(),console.log("AJAX request failed:",e)});else{commonFuncs.hideLoader();let e=t.getErrors(),i=document.createElement("ul");e.forEach(e=>{var t=document.createElement("li");t.textContent=e,t.style.color="red",t.style.textAlign="left",i.appendChild(t)}),Swal.fire({icon:"error",title:"Oops...",html:""+i.innerHTML,showClass:{popup:"animate__animated animate__fadeInDown"},hideClass:{popup:"animate__animated animate__fadeOutUp"}})}});class d{constructor(){this.errors=[]}validateMainCategory(e,t,i){return this.errors=[],this.validateCategories(t),this.validateSubcategories(i),0===this.errors.length}validateCategories(e){e&&0!==e.length?e.forEach(e=>{e.CategoryName&&""!==e.CategoryName.trim()||this.errors.push("Category name is required.")}):this.errors.push("At least one category is required.")}validateSubcategories(e){e&&0!==e.length?e.forEach(e=>{e.SubcategoryName&&""!==e.SubcategoryName.trim()||this.errors.push("Subcategory name is required.")}):this.errors.push("At least one subcategory is required.")}getErrors(){return this.errors}}function c(e){e.find(".delete-row").click(function(){Swal.fire({title:"Are you sure?",text:"You won't be able to revert this row!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Delete!"}).then(e=>{e.isConfirmed&&$(this).closest("tr").remove()})})}e.on("click",".add-subcategory-row-btn",function(){var e=$(this).closest(".subcategoryTable").find("tbody"),t=$('<tr class="sub-row">   <td><input type="text" class="form-control subcategory-name" required></td>   <td>       <button type="button" class="btn btn-danger delete-row m-1"><i class="fa fa-trash"></i></button>   </td></tr>');e.append(t),c(t)}),o.change(function(){var e=$(this).val();n.find("tbody").empty(),n.css("display",""!==o.val()?"block":"none"),a.css("display",""!==o.val()?"block":"none"),e&&(commonFuncs.showLoader(),$.post("/Worker/LoadMainCategoryData",{mainCategoryId:e},function(e){let t=e.categories,a=n.find("tbody");t.forEach(function(e){r++;let t=$(s);t.find(".category-name").val(e.name);var i=t.find("a");t.find(".subcategoryTable").attr("id","subcategoryTable-"+r),i.attr("aria-controls","subcategoryTable-"+r),i.attr("href","#subcategoryTable-"+r),e.subcategories.forEach(function(e){e='<tr class="sub-row">   <td><input type="text" class="form-control subcategory-name" required value="'+e.name+'"></td>   <td>       <button type="button" class="btn btn-danger delete-subcategory-row m-1"><i class="fa fa-trash"></i></button>   </td></tr>';t.find(".subcategory-tbody").append(e)}),a.append(t),commonFuncs.hideLoader()})}).fail(function(e){commonFuncs.hideLoader(),alert("AJAX request failed: ",e)}))}),i.click(function(){r++;var e=$(s),t=e.find("a");e.find(".subcategoryTable").attr("id","subcategoryTable-"+r),t.attr("aria-controls","subcategoryTable-"+r),t.attr("href","#subcategoryTable-"+r),n.find("#category-tbody").append(e),c(e)}),e.on("change",".category-name",function(){var e=n.closest("#subcategoryTable");e.attr("id","for-subcategories-"+$(this).val()),e.attr("href","#for-subcategories-"+$(this).val())})}};